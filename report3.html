<div class="cell code" data-execution_count="6">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">!</span>pip install matplotlib</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: matplotlib in ./env/lib/python3.8/site-packages (3.6.3)
Requirement already satisfied: packaging&gt;=20.0 in ./env/lib/python3.8/site-packages (from matplotlib) (22.0)
Requirement already satisfied: cycler&gt;=0.10 in ./env/lib/python3.8/site-packages (from matplotlib) (0.11.0)
Requirement already satisfied: python-dateutil&gt;=2.7 in ./env/lib/python3.8/site-packages (from matplotlib) (2.8.2)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in ./env/lib/python3.8/site-packages (from matplotlib) (1.4.4)
Requirement already satisfied: pyparsing&gt;=2.2.1 in ./env/lib/python3.8/site-packages (from matplotlib) (3.0.9)
Requirement already satisfied: contourpy&gt;=1.0.1 in ./env/lib/python3.8/site-packages (from matplotlib) (1.0.7)
Requirement already satisfied: fonttools&gt;=4.22.0 in ./env/lib/python3.8/site-packages (from matplotlib) (4.38.0)
Requirement already satisfied: pillow&gt;=6.2.0 in ./env/lib/python3.8/site-packages (from matplotlib) (9.4.0)
Requirement already satisfied: numpy&gt;=1.19 in ./env/lib/python3.8/site-packages (from matplotlib) (1.24.0)
Requirement already satisfied: six&gt;=1.5 in ./env/lib/python3.8/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib) (1.16.0)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span>  numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">import</span> math</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt   </span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="im">import</span> random</span></code></pre></div>
</div>
<section id="情報計算科学の基礎" class="cell markdown">
<h1>情報計算科学の基礎</h1>
<p>レポート3</p>
</section>
<div class="cell code" data-execution_count="8">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">def</span> gausselimination_withpivot(n,A,b):</span>
<span id="cb4-2"><a href="#cb4-2"></a>  x <span class="op">=</span> np.zeros(n)</span>
<span id="cb4-3"><a href="#cb4-3"></a>  Aorg <span class="op">=</span> np.copy(A)</span>
<span id="cb4-4"><a href="#cb4-4"></a>  borg <span class="op">=</span> np.copy(b)</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="co">#前進消去</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="co">#ピポット選択</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="cf">if</span> A[j][j] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb4-10"><a href="#cb4-10"></a>      <span class="bu">list</span> <span class="op">=</span> [A[i][j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(j<span class="op">+</span><span class="dv">1</span>,n)]</span>
<span id="cb4-11"><a href="#cb4-11"></a>      abs_list <span class="op">=</span> [<span class="bu">abs</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">list</span>]</span>
<span id="cb4-12"><a href="#cb4-12"></a>      m <span class="op">=</span> abs_list.index(<span class="bu">max</span>(abs_list))</span>
<span id="cb4-13"><a href="#cb4-13"></a>      p <span class="op">=</span> m <span class="op">+</span> j <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>      <span class="co">#交換</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>      b[j],b[p] <span class="op">=</span> b[p],b[j]</span>
<span id="cb4-16"><a href="#cb4-16"></a>      <span class="cf">for</span> c <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb4-17"><a href="#cb4-17"></a>        A[j][c],A[p][c] <span class="op">=</span> A[p][c],A[j][c]</span>
<span id="cb4-18"><a href="#cb4-18"></a></span>
<span id="cb4-19"><a href="#cb4-19"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(j<span class="op">+</span><span class="dv">1</span>,n,<span class="dv">1</span>):</span>
<span id="cb4-20"><a href="#cb4-20"></a>      coe<span class="op">=-</span>A[i][j]<span class="op">/</span>A[j][j]</span>
<span id="cb4-21"><a href="#cb4-21"></a>      <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(j,n,<span class="dv">1</span>):</span>
<span id="cb4-22"><a href="#cb4-22"></a>        A[i][k]<span class="op">+=</span>coe<span class="op">*</span>A[j][k]</span>
<span id="cb4-23"><a href="#cb4-23"></a>      b[i]<span class="op">+=</span>coe<span class="op">*</span>b[j]</span>
<span id="cb4-24"><a href="#cb4-24"></a>    </span>
<span id="cb4-25"><a href="#cb4-25"></a>  <span class="co">#後退代入・結果出力</span></span>
<span id="cb4-26"><a href="#cb4-26"></a>  <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n<span class="dv">-1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb4-27"><a href="#cb4-27"></a>    btmp<span class="op">=</span>b[j]</span>
<span id="cb4-28"><a href="#cb4-28"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="dv">-1</span>,j,<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb4-29"><a href="#cb4-29"></a>      btmp <span class="op">-=</span> A[j][i]<span class="op">*</span>x[i]</span>
<span id="cb4-30"><a href="#cb4-30"></a>    x[j]<span class="op">=</span>btmp<span class="op">/</span>A[j][j]</span>
<span id="cb4-31"><a href="#cb4-31"></a>  <span class="cf">return</span> x</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="17">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>EPSILON <span class="op">=</span>  <span class="fl">0.0001</span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw">def</span> fill_eigenlist(mat_to_solve_in,is_inv<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb5-4"><a href="#cb5-4"></a>    n_size_in <span class="op">=</span> <span class="bu">len</span>(mat_to_solve_in)</span>
<span id="cb5-5"><a href="#cb5-5"></a>    EValues <span class="op">=</span> [<span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(n_size_in)] <span class="co"># list for eigenvalues</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>    EVectors <span class="op">=</span> [ np.zeros(n_size_in) <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(n_size_in) ] <span class="co"># list for eigenvectors</span></span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="co"># print(&#39;Evectors&#39;)</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>    <span class="co"># print(EVectors)</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>    EV_list_in:<span class="bu">list</span> <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_size_in):</span>
<span id="cb5-12"><a href="#cb5-12"></a>        <span class="cf">if</span> is_inv:</span>
<span id="cb5-13"><a href="#cb5-13"></a>            eigen <span class="op">=</span> calc_eigen_inv(mat_to_solve_in,EVectors)</span>
<span id="cb5-14"><a href="#cb5-14"></a>        <span class="cf">else</span> :</span>
<span id="cb5-15"><a href="#cb5-15"></a>            eigen <span class="op">=</span> calc_eigen_conv(mat_to_solve_in,EVectors)</span>
<span id="cb5-16"><a href="#cb5-16"></a>        EVectors[i] <span class="op">=</span> eigen[<span class="st">&#39;vector&#39;</span>]</span>
<span id="cb5-17"><a href="#cb5-17"></a>        EValues[i] <span class="op">=</span> eigen[<span class="st">&#39;value&#39;</span>]</span>
<span id="cb5-18"><a href="#cb5-18"></a>        to_append <span class="op">=</span> {</span>
<span id="cb5-19"><a href="#cb5-19"></a>            <span class="st">&#39;value&#39;</span>:eigen[<span class="st">&#39;value&#39;</span>],</span>
<span id="cb5-20"><a href="#cb5-20"></a>            <span class="st">&#39;vector&#39;</span>:eigen[<span class="st">&#39;vector&#39;</span>]</span>
<span id="cb5-21"><a href="#cb5-21"></a>        }</span>
<span id="cb5-22"><a href="#cb5-22"></a>        EV_list_in.append(to_append)</span>
<span id="cb5-23"><a href="#cb5-23"></a>    <span class="co"># print(eigen)</span></span>
<span id="cb5-24"><a href="#cb5-24"></a>    <span class="co"># print(&quot;EVectors[0]&quot;)</span></span>
<span id="cb5-25"><a href="#cb5-25"></a>    <span class="co"># print(EVectors[0])</span></span>
<span id="cb5-26"><a href="#cb5-26"></a>    <span class="co"># print(&#39;Evectors&#39;)</span></span>
<span id="cb5-27"><a href="#cb5-27"></a>    <span class="co"># print(EVectors)</span></span>
<span id="cb5-28"><a href="#cb5-28"></a>    <span class="co"># eigen = calc_eigen_conv(mat_to_solve_in,EVectors)</span></span>
<span id="cb5-29"><a href="#cb5-29"></a>    EV_dict_in <span class="op">=</span> {</span>
<span id="cb5-30"><a href="#cb5-30"></a>        <span class="st">&#39;values&#39;</span>:EValues,</span>
<span id="cb5-31"><a href="#cb5-31"></a>        <span class="st">&#39;vectors&#39;</span>:EVectors</span>
<span id="cb5-32"><a href="#cb5-32"></a>    }</span>
<span id="cb5-33"><a href="#cb5-33"></a>    </span>
<span id="cb5-34"><a href="#cb5-34"></a></span>
<span id="cb5-35"><a href="#cb5-35"></a>    <span class="cf">return</span> EV_dict_in,EV_list_in</span>
<span id="cb5-36"><a href="#cb5-36"></a></span>
<span id="cb5-37"><a href="#cb5-37"></a><span class="kw">def</span> normarize_vecter(vector_in):</span>
<span id="cb5-38"><a href="#cb5-38"></a>    n_length_in <span class="op">=</span> <span class="bu">len</span>(vector_in)</span>
<span id="cb5-39"><a href="#cb5-39"></a>    answer_in <span class="op">=</span> np.zeros(n_length_in)</span>
<span id="cb5-40"><a href="#cb5-40"></a>    first_elem <span class="op">=</span> vector_in[<span class="dv">0</span>]</span>
<span id="cb5-41"><a href="#cb5-41"></a>    <span class="cf">for</span> i,elements <span class="kw">in</span> <span class="bu">enumerate</span>(vector_in):</span>
<span id="cb5-42"><a href="#cb5-42"></a>        answer_in[i] <span class="op">=</span> vector_in[i] <span class="op">/</span> first_elem</span>
<span id="cb5-43"><a href="#cb5-43"></a>    <span class="cf">return</span> answer_in</span>
<span id="cb5-44"><a href="#cb5-44"></a></span>
<span id="cb5-45"><a href="#cb5-45"></a><span class="kw">def</span> protter(EV_list_in,COORD_in,is_inv<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb5-46"><a href="#cb5-46"></a>    n_size_in <span class="op">=</span> <span class="bu">len</span>(EV_list_in)</span>
<span id="cb5-47"><a href="#cb5-47"></a>    <span class="cf">for</span> i,ei <span class="kw">in</span> <span class="bu">enumerate</span>(EV_list_in):</span>
<span id="cb5-48"><a href="#cb5-48"></a>        vec <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb5-49"><a href="#cb5-49"></a>        normed_vec <span class="op">=</span> normarize_vecter(ei[<span class="st">&#39;vector&#39;</span>])</span>
<span id="cb5-50"><a href="#cb5-50"></a>        <span class="cf">for</span> element <span class="kw">in</span> normed_vec:</span>
<span id="cb5-51"><a href="#cb5-51"></a>            vec.append(element)</span>
<span id="cb5-52"><a href="#cb5-52"></a>        </span>
<span id="cb5-53"><a href="#cb5-53"></a>        <span class="cf">if</span> is_inv:</span>
<span id="cb5-54"><a href="#cb5-54"></a>            mode_num <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb5-55"><a href="#cb5-55"></a>        <span class="cf">else</span>:</span>
<span id="cb5-56"><a href="#cb5-56"></a>            mode_num <span class="op">=</span> n_size_in <span class="op">-</span> i</span>
<span id="cb5-57"><a href="#cb5-57"></a>        </span>
<span id="cb5-58"><a href="#cb5-58"></a>        plt.plot(vec,COORD_in,label<span class="op">=</span><span class="ss">f&quot;</span><span class="sc">{</span>mode_num<span class="sc">}</span><span class="ss">th mode&quot;</span>)</span>
<span id="cb5-59"><a href="#cb5-59"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>mode_num<span class="sc">}</span><span class="ss">th mode:</span><span class="ch">\n\t</span><span class="ss">charactaristic frequency</span><span class="ch">\t</span><span class="ss">:</span><span class="sc">{</span>math<span class="sc">.</span>sqrt(<span class="op">-</span>ei[<span class="st">&#39;value&#39;</span>])<span class="sc">}</span><span class="ch">\n\t</span><span class="ss">eigan value</span><span class="ch">\t\t\t</span><span class="ss">:</span><span class="sc">{ei</span>[<span class="st">&#39;value&#39;</span>]<span class="sc">}</span><span class="ss">,</span><span class="ch">\n\t</span><span class="ss">eigan vector</span><span class="ch">\t\t\t</span><span class="ss">:</span><span class="sc">{</span>normed_vec<span class="sc">}</span><span class="ss"> &quot;</span>)</span>
<span id="cb5-60"><a href="#cb5-60"></a></span>
<span id="cb5-61"><a href="#cb5-61"></a><span class="kw">def</span> calc_eigen_conv(mat_to_solve_in,EVectors_in:<span class="bu">list</span>):</span>
<span id="cb5-62"><a href="#cb5-62"></a>    n_size_in <span class="op">=</span> <span class="bu">len</span>(mat_to_solve_in)</span>
<span id="cb5-63"><a href="#cb5-63"></a>    y_in <span class="op">=</span> np.random.rand(n_size_in)</span>
<span id="cb5-64"><a href="#cb5-64"></a>    </span>
<span id="cb5-65"><a href="#cb5-65"></a>    Ayj <span class="op">=</span> mat_to_solve_in <span class="op">@</span> y_in</span>
<span id="cb5-66"><a href="#cb5-66"></a>    y_in <span class="op">=</span> (Ayj)<span class="op">/</span>(np.linalg.norm(Ayj))</span>
<span id="cb5-67"><a href="#cb5-67"></a>    u_in <span class="op">=</span> np.dot(Ayj,y_in)</span>
<span id="cb5-68"><a href="#cb5-68"></a></span>
<span id="cb5-69"><a href="#cb5-69"></a>    u_error_rate <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb5-70"><a href="#cb5-70"></a>    <span class="cf">while</span> u_error_rate <span class="op">&gt;</span> EPSILON:</span>
<span id="cb5-71"><a href="#cb5-71"></a>        u_formar <span class="op">=</span> u_in</span>
<span id="cb5-72"><a href="#cb5-72"></a>        y_formar <span class="op">=</span> y_in</span>
<span id="cb5-73"><a href="#cb5-73"></a>        Ayj <span class="op">=</span> mat_to_solve_in <span class="op">@</span> y_formar</span>
<span id="cb5-74"><a href="#cb5-74"></a></span>
<span id="cb5-75"><a href="#cb5-75"></a>        frac <span class="op">=</span> Ayj <span class="co"># yjを求める分数の分母</span></span>
<span id="cb5-76"><a href="#cb5-76"></a>        <span class="cf">for</span> xj <span class="kw">in</span> EVectors_in:</span>
<span id="cb5-77"><a href="#cb5-77"></a>            frac<span class="op">-=</span> (np.dot(xj,Ayj))<span class="op">*</span>xj</span>
<span id="cb5-78"><a href="#cb5-78"></a>        y_in <span class="op">=</span> (frac)<span class="op">/</span>(np.linalg.norm(frac))</span>
<span id="cb5-79"><a href="#cb5-79"></a>        u_in <span class="op">=</span> np.dot(mat_to_solve_in <span class="op">@</span> y_in , y_in)</span>
<span id="cb5-80"><a href="#cb5-80"></a></span>
<span id="cb5-81"><a href="#cb5-81"></a>        u_error_rate <span class="op">=</span> <span class="bu">abs</span>(<span class="op">-</span><span class="dv">1</span> <span class="op">+</span> u_in<span class="op">/</span>u_formar )</span>
<span id="cb5-82"><a href="#cb5-82"></a>        <span class="co"># print(f&#39;u_error_rate\t:{u_error_rate}&#39;)</span></span>
<span id="cb5-83"><a href="#cb5-83"></a>        <span class="co"># print(f&#39;u_in\t\t:{u_in}&#39;)</span></span>
<span id="cb5-84"><a href="#cb5-84"></a>        <span class="co"># print(f&#39;u_error_rate:{u_error_rate}&#39;)</span></span>
<span id="cb5-85"><a href="#cb5-85"></a></span>
<span id="cb5-86"><a href="#cb5-86"></a>    eigenvalue <span class="op">=</span> u_in</span>
<span id="cb5-87"><a href="#cb5-87"></a>    eigenvector <span class="op">=</span> np.zeros(n_size_in)</span>
<span id="cb5-88"><a href="#cb5-88"></a>    <span class="co"># print(eigenvalue)</span></span>
<span id="cb5-89"><a href="#cb5-89"></a></span>
<span id="cb5-90"><a href="#cb5-90"></a>    <span class="co"># for i,yelement in enumerate(y_in):</span></span>
<span id="cb5-91"><a href="#cb5-91"></a>    <span class="co">#     eigenvector[i] = (yelement/y_in[0])</span></span>
<span id="cb5-92"><a href="#cb5-92"></a>    </span>
<span id="cb5-93"><a href="#cb5-93"></a>    eigenvector <span class="op">=</span> y_in</span>
<span id="cb5-94"><a href="#cb5-94"></a>    <span class="co"># print(&#39;eigenvector&#39;)</span></span>
<span id="cb5-95"><a href="#cb5-95"></a>    <span class="co"># print(eigenvector)</span></span>
<span id="cb5-96"><a href="#cb5-96"></a>    <span class="co"># print(&#39;y_in&#39;)</span></span>
<span id="cb5-97"><a href="#cb5-97"></a>    <span class="co"># print(y_in)</span></span>
<span id="cb5-98"><a href="#cb5-98"></a>    <span class="co"># print(&#39;y_in[0]:&#39;)</span></span>
<span id="cb5-99"><a href="#cb5-99"></a>    <span class="co"># print(y_in[0])</span></span>
<span id="cb5-100"><a href="#cb5-100"></a></span>
<span id="cb5-101"><a href="#cb5-101"></a>    eigen <span class="op">=</span> {</span>
<span id="cb5-102"><a href="#cb5-102"></a>                <span class="st">&#39;value&#39;</span>:eigenvalue,</span>
<span id="cb5-103"><a href="#cb5-103"></a>                <span class="st">&#39;vector&#39;</span>:eigenvector</span>
<span id="cb5-104"><a href="#cb5-104"></a>            }</span>
<span id="cb5-105"><a href="#cb5-105"></a>    <span class="cf">return</span> eigen</span>
<span id="cb5-106"><a href="#cb5-106"></a></span>
<span id="cb5-107"><a href="#cb5-107"></a><span class="kw">def</span> inv_mat(A):</span>
<span id="cb5-108"><a href="#cb5-108"></a>    n_size_of_A <span class="op">=</span> <span class="bu">len</span>(A)</span>
<span id="cb5-109"><a href="#cb5-109"></a>    X <span class="op">=</span> np.eye(n_size_of_A)</span>
<span id="cb5-110"><a href="#cb5-110"></a>    <span class="co">#まずAを上三角行列にする。</span></span>
<span id="cb5-111"><a href="#cb5-111"></a>    A <span class="op">=</span> A.astype(<span class="st">&#39;float64&#39;</span>)</span>
<span id="cb5-112"><a href="#cb5-112"></a>    <span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(n_size_of_A):</span>
<span id="cb5-113"><a href="#cb5-113"></a>        pivot <span class="op">=</span> A[p][p]</span>
<span id="cb5-114"><a href="#cb5-114"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(p<span class="op">+</span><span class="dv">1</span>, n_size_of_A):</span>
<span id="cb5-115"><a href="#cb5-115"></a>            coef <span class="op">=</span> A[j][p] <span class="op">/</span> pivot</span>
<span id="cb5-116"><a href="#cb5-116"></a>            A[j] <span class="op">-=</span> A[p] <span class="op">*</span> coef</span>
<span id="cb5-117"><a href="#cb5-117"></a>            X[j] <span class="op">-=</span> X[p] <span class="op">*</span> coef</span>
<span id="cb5-118"><a href="#cb5-118"></a>    <span class="co">#途中経過確認。</span></span>
<span id="cb5-119"><a href="#cb5-119"></a>    <span class="co">#print(A)</span></span>
<span id="cb5-120"><a href="#cb5-120"></a>    <span class="co">#print(X)</span></span>
<span id="cb5-121"><a href="#cb5-121"></a>    <span class="co">#対角成分を1にする。</span></span>
<span id="cb5-122"><a href="#cb5-122"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_size_of_A):</span>
<span id="cb5-123"><a href="#cb5-123"></a>        X[i] <span class="op">/=</span> A[i][i]</span>
<span id="cb5-124"><a href="#cb5-124"></a>        A[i] <span class="op">/=</span> A[i][i]</span>
<span id="cb5-125"><a href="#cb5-125"></a>    <span class="co">#途中経過確認。</span></span>
<span id="cb5-126"><a href="#cb5-126"></a>    <span class="co">#print(A)</span></span>
<span id="cb5-127"><a href="#cb5-127"></a>    <span class="co">#print(X)</span></span>
<span id="cb5-128"><a href="#cb5-128"></a>    <span class="co">#答えを出す。</span></span>
<span id="cb5-129"><a href="#cb5-129"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_size_of_A<span class="dv">-1</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb5-130"><a href="#cb5-130"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i):</span>
<span id="cb5-131"><a href="#cb5-131"></a>            X[j] <span class="op">-=</span> X[i] <span class="op">*</span> A[j][i]</span>
<span id="cb5-132"><a href="#cb5-132"></a>            A[j][i] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-133"><a href="#cb5-133"></a>    <span class="cf">return</span> X</span>
<span id="cb5-134"><a href="#cb5-134"></a></span>
<span id="cb5-135"><a href="#cb5-135"></a><span class="kw">def</span> calc_eigen_inv(mat_to_solve_in,EVectors_in:<span class="bu">list</span>):</span>
<span id="cb5-136"><a href="#cb5-136"></a>    n_size_in <span class="op">=</span> <span class="bu">len</span>(mat_to_solve_in)</span>
<span id="cb5-137"><a href="#cb5-137"></a>    e_i <span class="op">=</span> np.zeros(n_size_in) <span class="co"># base vector</span></span>
<span id="cb5-138"><a href="#cb5-138"></a>    mat_inverse <span class="op">=</span> inv_mat(mat_to_solve_in)</span>
<span id="cb5-139"><a href="#cb5-139"></a>    </span>
<span id="cb5-140"><a href="#cb5-140"></a>    <span class="co"># print(&#39;mat_inverse&#39;)</span></span>
<span id="cb5-141"><a href="#cb5-141"></a>    <span class="co"># print(mat_inverse)</span></span>
<span id="cb5-142"><a href="#cb5-142"></a>    <span class="co"># print(&#39;conv@inv&#39;)</span></span>
<span id="cb5-143"><a href="#cb5-143"></a>    <span class="co"># print(mat_inverse @ mat_to_solve)</span></span>
<span id="cb5-144"><a href="#cb5-144"></a></span>
<span id="cb5-145"><a href="#cb5-145"></a></span>
<span id="cb5-146"><a href="#cb5-146"></a>    eigen <span class="op">=</span> calc_eigen_conv(mat_inverse,EVectors_in)</span>
<span id="cb5-147"><a href="#cb5-147"></a>    eigen[<span class="st">&#39;value&#39;</span>] <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> eigen[<span class="st">&#39;value&#39;</span>]</span>
<span id="cb5-148"><a href="#cb5-148"></a></span>
<span id="cb5-149"><a href="#cb5-149"></a>    <span class="cf">return</span> eigen</span>
<span id="cb5-150"><a href="#cb5-150"></a>    </span>
<span id="cb5-151"><a href="#cb5-151"></a></span>
<span id="cb5-152"><a href="#cb5-152"></a>mat_to_solve <span class="op">=</span> np.array(([<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>],[ <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb5-153"><a href="#cb5-153"></a>EV_dict,EV_list <span class="op">=</span> fill_eigenlist(mat_to_solve)</span>
<span id="cb5-154"><a href="#cb5-154"></a><span class="bu">print</span>(EV_dict)</span>
<span id="cb5-155"><a href="#cb5-155"></a><span class="bu">print</span>(EV_list)</span>
<span id="cb5-156"><a href="#cb5-156"></a></span>
<span id="cb5-157"><a href="#cb5-157"></a><span class="co"># print((-3-math.sqrt(5))/2)</span></span>
<span id="cb5-158"><a href="#cb5-158"></a><span class="co"># print((-3+math.sqrt(5))/2)</span></span>
<span id="cb5-159"><a href="#cb5-159"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>{&#39;values&#39;: [-2.6180301931881704, -0.38196980681182946], &#39;vectors&#39;: [array([ 0.85133504, -0.52462239]), array([-0.52462239, -0.85133504])]}
[{&#39;value&#39;: -2.6180301931881704, &#39;vector&#39;: array([ 0.85133504, -0.52462239])}, {&#39;value&#39;: -0.38196980681182946, &#39;vector&#39;: array([-0.52462239, -0.85133504])}]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>(1) n=2のmode</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>mat_to_solve <span class="op">=</span> np.array(([<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>],[ <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb7-2"><a href="#cb7-2"></a>EV_dict,EV_list <span class="op">=</span> fill_eigenlist(mat_to_solve)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># print(EV_dict)</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># print(EV_list)</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>n_size_in <span class="op">=</span> <span class="bu">len</span>(mat_to_solve)</span>
<span id="cb7-6"><a href="#cb7-6"></a>COORD <span class="op">=</span> [num <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(n_size_in <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a>protter(EV_list,COORD)</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co"># plt.plot([0,-0.85099324,  0.52517665],[0,1,2] )</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>plt.plot([<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">2</span>],color<span class="op">=</span><span class="st">&#39;#000000&#39;</span>,label<span class="op">=</span><span class="st">&#39;z-axis&#39;</span>)</span>
<span id="cb7-12"><a href="#cb7-12"></a>plt.legend()</span>
<span id="cb7-13"><a href="#cb7-13"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>2th mode:
	charactaristic frequency	:1.6180329348616178
	eigan value			:-2.6180305782969007,
	eigan vector			:[ 1.         -0.61974201] 
1th mode:
	charactaristic frequency	:0.6180367478581669
	eigan value			:-0.38196942170309933,
	eigan vector			:[1.         1.61357466] 
</code></pre>
</div>
<div class="output display_data">
<p><img src="rep3_1.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>2th mode: charactaristic frequency :1.6180325349761728 eigan value :-2.6180292842414197, eigan vector :[ 0.85141248 -0.5244967 ] 1th mode: charactaristic frequency :0.6180377947654826 eigan value :-0.38197071575858077, eigan vector :[-0.5244967 -0.85141248]</p>
</div>
<div class="cell markdown">
<p>(2) n=6の場合</p>
</div>
<div class="cell code" data-execution_count="91">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>mat_to_solve <span class="op">=</span> np.array(([<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,],[ <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],[ <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],[ <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>],[ <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>],[ <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb9-2"><a href="#cb9-2"></a>EV_dict,EV_list <span class="op">=</span> fill_eigenlist(mat_to_solve)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># print(EV_dict)</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># print(EV_list)</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>n_size_in <span class="op">=</span> <span class="bu">len</span>(mat_to_solve)</span>
<span id="cb9-6"><a href="#cb9-6"></a>COORD <span class="op">=</span> [num <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(n_size_in <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="cf">for</span> i,ei <span class="kw">in</span> <span class="bu">enumerate</span>(EV_list):</span>
<span id="cb9-9"><a href="#cb9-9"></a>    vec <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="cf">for</span> element <span class="kw">in</span> ei[<span class="st">&#39;vector&#39;</span>]:</span>
<span id="cb9-11"><a href="#cb9-11"></a>        vec.append(element)</span>
<span id="cb9-12"><a href="#cb9-12"></a>    </span>
<span id="cb9-13"><a href="#cb9-13"></a>    plt.plot(vec,COORD,label<span class="op">=</span><span class="ss">f&quot;</span><span class="sc">{</span>n_size_in <span class="op">-</span> <span class="sc">i}</span><span class="ss">th mode&quot;</span>)</span>
<span id="cb9-14"><a href="#cb9-14"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>n_size_in <span class="op">-</span> <span class="sc">i}</span><span class="ss">th mode:</span><span class="ch">\n\t</span><span class="ss">charactaristic frequency</span><span class="ch">\t</span><span class="ss">:</span><span class="sc">{</span>math<span class="sc">.</span>sqrt(<span class="op">-</span>ei[<span class="st">&#39;value&#39;</span>])<span class="sc">}</span><span class="ch">\n\t</span><span class="ss">eigan value</span><span class="ch">\t\t\t</span><span class="ss">:</span><span class="sc">{ei</span>[<span class="st">&#39;value&#39;</span>]<span class="sc">}</span><span class="ss">,</span><span class="ch">\n\t</span><span class="ss">eigan vector</span><span class="ch">\t\t\t</span><span class="ss">:</span><span class="sc">{ei</span>[<span class="st">&#39;vector&#39;</span>]<span class="sc">}</span><span class="ss"> &quot;</span>)</span>
<span id="cb9-15"><a href="#cb9-15"></a></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co"># plt.plot([0,-0.85099324,  0.52517665],[0,1,2] )</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>plt.plot([<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">0</span>,n_size_in],color<span class="op">=</span><span class="st">&#39;#000000&#39;</span>,label<span class="op">=</span><span class="st">&#39;z-axis&#39;</span>)</span>
<span id="cb9-18"><a href="#cb9-18"></a>plt.legend()</span>
<span id="cb9-19"><a href="#cb9-19"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>6th mode:
	charactaristic frequency	:1.9416774631433877
	eigan value			:-3.770111370878942,
	eigan vector			:[ 0.24140602 -0.43780104  0.54559405 -0.53139041  0.38715877 -0.14181976] 
5th mode:
	charactaristic frequency	:1.7710696900605294
	eigan value			:-3.1366878470510993,
	eigan vector			:[ 0.47437864 -0.53664458  0.14366648  0.35336543 -0.52966601  0.24682837] 
4th mode:
	charactaristic frequency	:1.4970773730478377
	eigan value			:-2.241240660891815,
	eigan vector			:[-0.5475147   0.12066518  0.52335571 -0.2471019  -0.46408552  0.3678745 ] 
3th mode:
	charactaristic frequency	:1.136153470330008
	eigan value			:-1.2908447081429202,
	eigan vector			:[-0.51567342 -0.37173685  0.25081003  0.55219357  0.13818274 -0.45713757] 
2th mode:
	charactaristic frequency	:0.7092242510686345
	eigan value			:-0.5029990383038655,
	eigan vector			:[-0.36522424 -0.54880278 -0.45785099 -0.13563647  0.25700452  0.52091329] 
1th mode:
	charactaristic frequency	:0.24107338038729548
	eigan value			:-0.05811637473135765,
	eigan vector			:[-0.13269465 -0.25770135 -0.36776716 -0.45648961 -0.51869147 -0.5507321 ] 
</code></pre>
</div>
<div class="output display_data">
<p><img src="rep3_2.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>ベクトル1つ目の成分が＋1になるように正規化をすると以下のようになった。</p>
</div>
<div class="cell code" data-execution_count="14">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>mat_to_solve <span class="op">=</span> np.array(([<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,],[ <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],[ <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],[ <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>],[ <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>],[ <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb11-2"><a href="#cb11-2"></a>EV_dict,EV_list <span class="op">=</span> fill_eigenlist(mat_to_solve)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co"># print(EV_dict)</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co"># print(EV_list)</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>n_size_in <span class="op">=</span> <span class="bu">len</span>(mat_to_solve)</span>
<span id="cb11-6"><a href="#cb11-6"></a>COORD <span class="op">=</span> [num <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(n_size_in <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a>protter(EV_list,COORD)</span>
<span id="cb11-9"><a href="#cb11-9"></a></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co"># plt.plot([0,-0.85099324,  0.52517665],[0,1,2] )</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>plt.plot([<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">0</span>,n_size_in],color<span class="op">=</span><span class="st">&#39;#000000&#39;</span>,label<span class="op">=</span><span class="st">&#39;z-axis&#39;</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a>plt.legend()</span>
<span id="cb11-13"><a href="#cb11-13"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>6th mode:
	charactaristic frequency	:1.9417103499794979
	eigan value			:-3.770239083217504,
	eigan vector			:[ 1.         -1.73621378  2.03532815 -1.85817707  1.28327267 -0.45608552] 
5th mode:
	charactaristic frequency	:1.7710196976398414
	eigan value			:-3.136510769428315,
	eigan vector			:[ 1.         -1.10638505  0.23075585  0.85147137 -1.21106562  0.55751139] 
4th mode:
	charactaristic frequency	:1.4970967083112257
	eigan value			:-2.241298554036307,
	eigan vector			:[ 1.         -0.23543719 -0.96347467  0.47458665  0.86901323 -0.69921739] 
3th mode:
	charactaristic frequency	:1.136156083745234
	eigan value			:-1.2908506466313074,
	eigan vector			:[ 1.          0.70166628 -0.49721844 -1.04474302 -0.24773071  0.86204474] 
2th mode:
	charactaristic frequency	:0.7092140086992829
	eigan value			:-0.5029845101353065,
	eigan vector			:[ 1.          1.50024423  1.24819287  0.3669257  -0.70192915 -1.41824728] 
1th mode:
	charactaristic frequency	:0.24107350860528026
	eigan value			:-0.05811643655126014,
	eigan vector			:[1.         1.94237258 2.77259788 3.44230617 3.91214419 4.15427749] 
</code></pre>
</div>
<div class="output display_data">
<p><img src="rep3_3.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>(3) n=6 を逆べき乗法で解く</p>
</div>
<div class="cell code" data-execution_count="18">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>mat_to_solve <span class="op">=</span> np.array(([<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,],[ <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],[ <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],[ <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>],[ <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>],[ <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb13-2"><a href="#cb13-2"></a>EV_dict,EV_list <span class="op">=</span> fill_eigenlist(mat_to_solve,<span class="va">True</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co"># print(EV_dict)</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># print(EV_list)</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>n_size_in <span class="op">=</span> <span class="bu">len</span>(mat_to_solve)</span>
<span id="cb13-6"><a href="#cb13-6"></a>COORD <span class="op">=</span> [num <span class="cf">for</span> num <span class="kw">in</span> <span class="bu">range</span>(n_size_in <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a>protter(EV_list,COORD,<span class="va">True</span>)</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co"># plt.plot([0,-0.85099324,  0.52517665],[0,1,2] )</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>plt.plot([<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">0</span>,n_size_in],color<span class="op">=</span><span class="st">&#39;#000000&#39;</span>,label<span class="op">=</span><span class="st">&#39;z-axis&#39;</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a>plt.legend()</span>
<span id="cb13-13"><a href="#cb13-13"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1th mode:
	charactaristic frequency	:0.24107336116062464
	eigan value			:-0.05811636546128096,
	eigan vector			:[1.         1.9416943  2.77054064 3.43861922 3.90706299 4.1484292 ] 
2th mode:
	charactaristic frequency	:0.7092100661053015
	eigan value			:-0.5029789178650861,
	eigan vector			:[ 1.          1.49844322  1.24495595  0.36289182 -0.70236142 -1.41316049] 
3th mode:
	charactaristic frequency	:1.1361515628796055
	eigan value			:-1.2908403738337704,
	eigan vector			:[ 1.          0.71967034 -0.49105408 -1.07675385 -0.26766164  0.89465739] 
4th mode:
	charactaristic frequency	:1.4970277334726472
	eigan value			:-2.2410920347862513,
	eigan vector			:[ 1.         -0.24493419 -0.91886138  0.4574455   0.79176941 -0.63762537] 
5th mode:
	charactaristic frequency	:1.7709623316877243
	eigan value			:-3.136307580256821,
	eigan vector			:[ 1.         -1.14382766  0.28229339  0.86529306 -1.29747842  0.6105383 ] 
6th mode:
	charactaristic frequency	:1.9416872296857703
	eigan value			:-3.7701492979248017,
	eigan vector			:[ 1.         -1.74366313  2.05003232 -1.8722423   1.29016137 -0.45724548] 
</code></pre>
</div>
<div class="output display_data">
<p><img src="rep3_4.png" /></p>
</div>
</div>
